<!DOCTYPE html>
<html>
<head prefix="og: http://ogp.me/ns#">
  <meta charset="utf-8">
  <title>Regularjs - Rethink declarative animation</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <link rel="shortcut icon" href="/icon.png" >
  <link rel="canonical" href="http://regularjs.github.io/blog/2014/07/26/2014-7-26-animation-rethink/">
  <link rel="stylesheet" href="/bower_components/codemirror/lib/codemirror.css" type="text/css">

  <link rel="stylesheet" href="/css/style.css" type="text/css">

  
  <meta name="description" content="Introduction
Today, beacuse of new trends like material design and motion design, the animation is become more and more important in web-development.
On the other hand, thanks for the standardized web">
<meta property="og:type" content="article">
<meta property="og:title" content="Rethink declarative animation">
<meta property="og:url" content="http://regularjs.github.io/blog/2014/07/26/2014-7-26-animation-rethink/">
<meta property="og:site_name" content="Regularjs">
<meta property="og:description" content="Introduction
Today, beacuse of new trends like material design and motion design, the animation is become more and more important in web-development.
On the other hand, thanks for the standardized web">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Rethink declarative animation">
<meta name="twitter:description" content="Introduction
Today, beacuse of new trends like material design and motion design, the animation is become more and more important in web-development.
On the other hand, thanks for the standardized web">
<meta name="twitter:site" content="@regularjs">

  
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-54220110-1', 'regularjs.github.io');
  ga('send', 'pageview');
</script>

</head>

<body>
  <header class="g-top" id='header'>
  <div class="m-nav m-nav-2 g-cnt">
    <div class="logo"><a href="/" class="inner"><img src="/image/regular-icon-neg.png" alt="" with=50 height=50></a></div>
    
    <ul class="nav">
      
        <li> <a href="/example/markdown.html" class=" inner">Example</a></li>
      
        <li> <a href="/guide" class=" inner">Guide</a></li>
      
        <li> <a href="/reference/" class=" inner">Reference</a></li>
      
        <li> <a href="/blog/" class=" inner">Blog</a></li>
      
        <li> <a href="https://github.com/regularjs/regular" class=" inner">Github</a></li>
      
      <li><a href="#" id="search-btn" class="icon-search2  st-search-launcher icon" title="Search"></a></li>
      
    </ul>
  </div>
</header>



  <div class="m-subtitle"> 
  <h2>Blog <a class="icon icon-feed2" href="/atom.xml"></a></h2>
</div>

<div class="g-bd">
  <article class="post" itemscope itemtype="http://schema.org/Article">
  <header class="post-header">
    
  
    <h1 class="post-title" itemprop="name">
      Rethink declarative animation
    </h1>
  

    <div class="post-date-wrap">
  <a href="/blog/2014/07/26/2014-7-26-animation-rethink/" class="post-date">
    <time datetime="2014-07-25T16:00:00.000Z" itemprop="datePublished">Jul 26 2014</time>
  </a>
</div>
  </header>
  <div class="entry  m-markdown">
    
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Introduction"><span class="toc-text">Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Real_World_Declartive_Animation"><span class="toc-text">Real World  Declartive Animation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Angular"><span class="toc-text">Angular</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Anijs"><span class="toc-text">Anijs</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Vuejs"><span class="toc-text">Vuejs</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#React"><span class="toc-text">React</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Summary"><span class="toc-text">Summary</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#An_Even_Better_Solution_for_declarative_animation!"><span class="toc-text">An Even Better Solution for declarative animation!</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Question_1:_When_the_animation_start"><span class="toc-text">Question 1: When the animation start</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#however,_how_to_hook_the_enter_and_leave_time_on_element?"><span class="toc-text">however, how to hook the enter and leave time on element?</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Is_there_any_other_trigger?"><span class="toc-text">Is there any other trigger?</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Question_2:_How_to_make_the_animation_chainable?"><span class="toc-text">Question 2: How to make the animation chainable?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Question_3:_How_to_animation_two_element_step_by_step?"><span class="toc-text">Question 3: How to animation two element step by step?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Question_4:_Is_there_any_other_buildin_command?"><span class="toc-text">Question 4: Is there any other buildin command?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Question_5:_How_to_extend_Custom_Command?"><span class="toc-text">Question 5: How to extend Custom Command?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Question_6:_Need_An_compeletely_Example?"><span class="toc-text">Question 6: Need An compeletely Example?</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#End"><span class="toc-text">End</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#if_the_post_is_helpful_to_you,_gives_regularjs_a_star"><span class="toc-text">if the post is helpful to you,  gives regularjs a star</span></a></li></ol></li></ol> </ol>
      <h2 id="Introduction">Introduction</h2>
<p>Today, beacuse of new trends like <a href="http://www.google.com/design/spec/material-design/introduction.html" target="_blank" rel="external">material design</a> and motion design, the animation is become more and more important in web-development.</p>
<p>On the other hand, thanks for the standardized <a href="">web-component</a> and frameworks like angularjs, knockoutjs, reactjs and vuejs etc.  building the view of application in declartive way is coming into popular .</p>
<blockquote>
<p><strong>So, what about declarative animation? </strong></p>
</blockquote>
<p>This article serves to demonstrate an even better solution for declarative animation. before diving into detail, let’s first check ‘Real World  Declartive Animation’ .</p>
<a id="more"></a>
<h2 id="Real_World_Declartive_Animation">Real World  Declartive Animation</h2>
<p>This section will introduce the exsited approaches to implement declarative animation</p>
<h3 id="Angular">Angular</h3>
<p><a href="https://github.com/angular/angular.js" target="_blank" rel="external">angular</a> is the most popular framework that have nearly 27000 stars on github now. </p>
<p>in angularjs,  animation support is based on the module <code>ngAnimate</code> . The directives that support animation automatically are: ngRepeat, ngInclude, ngIf, ngSwitch, ngShow, ngHide, ngView and ngClass.</p>
<p>you need to define the appropriate CSS classes or to register a JavaScript animation via the module.animation() function.</p>
<p><strong>Example</strong></p>
<figure class="highlight html"><pre><div class="line"><span class="tag">&lt;<span class="title">style</span> <span class="attribute">type</span>=<span class="value">"text/css"</span>&gt;</span><span class="css"></span></div><div class="line"><span class="class">.slide</span><span class="class">.ng-enter</span>, <span class="class">.slide</span><span class="class">.ng-leave</span> <span class="rules">{</span></div><div class="line">  <span class="rule"><span class="attribute">-webkit-transition</span>:<span class="value"><span class="number">0.5s</span> linear all</span></span>;</div><div class="line">  <span class="rule"><span class="attribute">transition</span>:<span class="value"><span class="number">0.5s</span> linear all</span></span>;</div><div class="line"><span class="rule">}</span></div><div class="line"></div><div class="line"><span class="class">.slide</span><span class="class">.ng-enter</span> <span class="rules">{ <span class="rule">}</span></span>        <span class="comment">/* starting animations for enter */</span></div><div class="line"><span class="class">.slide</span><span class="class">.ng-enter-active</span> <span class="rules">{ <span class="rule">}</span></span> <span class="comment">/* terminal animations for enter */</span></div><div class="line"><span class="class">.slide</span><span class="class">.ng-leave</span> <span class="rules">{ <span class="rule">}</span></span>        <span class="comment">/* starting animations for leave */</span></div><div class="line"><span class="class">.slide</span><span class="class">.ng-leave-active</span> <span class="rules">{ <span class="rule">}</span></span> <span class="comment">/* terminal animations for leave */</span></div><div class="line"><span class="tag">&lt;/<span class="title">style</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!--</span></div><div class="line">the animate service will automatically add .ng-enter and .ng-leave to the element</div><div class="line">to trigger the CSS transition/animations</div><div class="line">--&gt;</div><div class="line"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"slide"</span> <span class="attribute">ng-if</span>=<span class="value">"Expression"</span>&gt;</span><span class="tag">&lt;/<span class="title">div</span>&gt;</span></div></pre></figure>

<p>when the <code>Expression</code> is evaluated to <code>true</code>, the  class<code>ng-enter</code> is added first to  prepares initial state, then <code>ng-enter-active</code> is added at nextReflow(similar with <code>setTimeout(0)</code>). </p>
<h3 id="Anijs"><a href="https://github.com/anijs/anijs" target="_blank" rel="external">Anijs</a></h3>
<blockquote>
<p>Anijs: Declarative handling library for CSS animations. </p>
</blockquote>
<p>anijs’s main objective is to provide an eloquent, easy to translate, and quick to develop environment based on css animations.</p>
<p><strong>Example</strong></p>
<figure class="highlight html"><pre><div class="line"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">id</span>=<span class="value">"main"</span> <span class="attribute">data-anijs</span>=<span class="value">"if: DOMContentLoaded, on: document, do: swing animated, after: holdAnimClass"</span>&gt;</span><span class="tag">&lt;/<span class="title">div</span>&gt;</span></div></pre></figure>

<p>the exmpale above means: </p>
<p>when  <code>DOMContentLoaded</code>  triggered on document, addClass <code>swing</code> <code>animated</code>, then hold them after animationend(or transitionend). </p>
<p>It is dead simple and intuitive. the only requirement is to include a 8kb jsfile(minified, no gzip).</p>
<h3 id="Vuejs"><a href="http://vuejs.org/" target="_blank" rel="external">Vuejs</a></h3>
<p>vuejs’s animation-support is very lightweight. just like angular, it hooks the element’s lifecycle at <code>enter</code> and <code>leave</code>  (based on directive, e.g. <code>v-if</code>). you can use three directive to customize your animation</p>
<ol>
<li><code>v-animation</code>  animation based on class and animation</li>
<li><code>v-transition</code>: animation based on class and transition </li>
<li><code>v-effect</code>: custom animation extension.</li>
</ol>
<p><strong>example</strong><br>use <code>animation</code> or <code>transition</code></p>
<figure class="highlight html"><pre><div class="line"><span class="tag">&lt;<span class="title">p</span> <span class="attribute">class</span>=<span class="value">"animated"</span> <span class="attribute">v-if</span>=<span class="value">"show"</span> <span class="attribute">v-animation</span>&gt;</span>Look at me!<span class="tag">&lt;/<span class="title">p</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">p</span> <span class="attribute">class</span>=<span class="value">"msg"</span> <span class="attribute">v-if</span>=<span class="value">"show"</span> <span class="attribute">v-transition</span>&gt;</span>Hello!<span class="tag">&lt;/<span class="title">p</span>&gt;</span></div></pre></figure>

<p>use custom effect</p>
<figure class="highlight html"><pre><div class="line"><span class="tag">&lt;<span class="title">p</span> <span class="attribute">v-effect</span>=<span class="value">"my-effect"</span>&gt;</span><span class="tag">&lt;/<span class="title">p</span>&gt;</span></div></pre></figure>



<figure class="highlight javascript"><pre><div class="line">Vue.effect(<span class="string">'my-effect'</span>, {</div><div class="line">    enter: <span class="function"><span class="keyword">function</span> <span class="params">(el, insert, timeout)</span> </span>{</div><div class="line">        <span class="comment">// insert() will actually insert the element</span></div><div class="line">    },</div><div class="line">    leave: <span class="function"><span class="keyword">function</span> <span class="params">(el, remove, timeout)</span> </span>{</div><div class="line">        <span class="comment">// remove() will actually remove the element</span></div><div class="line">    }</div><div class="line">})</div></pre></figure>

<p>To be honest, I don’t know why vuejs make distinguish between these three cases.</p>
<h3 id="React"><a href="http://facebook.github.io/react/" target="_blank" rel="external">React</a></h3>
<p>React’s animation support is based on the low-level API: <code>ReactTransitionGroup</code>. you can check the introduction of <code>ReactCSSTransitionGroup</code>(High-level API) on its <a href="http://facebook.github.io/react/docs/animation.html#getting-started" target="_blank" rel="external">animation page</a></p>
<p><strong>Example</strong></p>
<figure class="highlight"><pre><div class="line"><span class="javadoc">/** <span class="javadoctag">@jsx</span> React.DOM */</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> ReactCSSTransitionGroup = React.addons.CSSTransitionGroup;</div><div class="line"></div><div class="line"><span class="keyword">var</span> TodoList = React.createClass({</div><div class="line">  <span class="comment">// ignored some methods for short</span></div><div class="line">  render: function() {</div><div class="line">    <span class="keyword">var</span> items = <span class="keyword">this</span>.state.items.map(function(item, i) {</div><div class="line">      <span class="keyword">return</span> (</div><div class="line">        &lt;div key={item} onClick={<span class="keyword">this</span>.handleRemove.bind(<span class="keyword">this</span>, i)}&gt;</div><div class="line">          {item}</div><div class="line">        &lt;/div&gt;</div><div class="line">      );</div><div class="line">    }.bind(<span class="keyword">this</span>));</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;div&gt;</div><div class="line">        &lt;button onClick={<span class="keyword">this</span>.handleAdd}&gt;Add Item&lt;/button&gt;</div><div class="line">        &lt;ReactCSSTransitionGroup transitionName=<span class="string">"example"</span>&gt;</div><div class="line">          {items}</div><div class="line">        &lt;/ReactCSSTransitionGroup&gt;</div><div class="line">      &lt;/div&gt;</div><div class="line">    );</div><div class="line">  }</div><div class="line">});</div></pre></figure>

<p>The element that wrapped by  <code>ReactCSSTransitionGroup</code> can animate when it is injected to or leave from the component.  it will get the <code>example-enter</code> CSS class and the <code>example-enter-active</code> CSS class added in the next tick (similar with angular). This is a convention based on the transitionName prop.</p>
<h3 id="Summary">Summary</h3>
<p>compare with the <code>JavaScript-Based Animation</code>(e.g.  <a href="http://velocityjs.org/" target="_blank" rel="external">Velocity.js</a> or jquery), the <code>declarative animation</code> that introduced above is obviously less flexible. for example:</p>
<ol>
<li>only works in given environment .(e.g. when element <code>enter</code> or <code>leave</code>)</li>
<li>can not chainable</li>
<li>can not combine with other elements’s  animation</li>
<li>developer know nothing about the phase of the animation. (image that you need do some work in javascript when the animation is done)</li>
</ol>
<h2 id="An_Even_Better_Solution_for_declarative_animation!">An Even Better Solution for declarative animation!</h2>
<p>The solution  introduced later that has been implemented in <a href="https://github.com/regularjs/regular" target="_blank" rel="external">regularjs</a> yet. and it can be full-supported by any framework that is data-driven(e.g. angularjs, vuejs, ractivejs..).</p>
<p>the solution is based on single directive: <code>r-animation</code>. </p>
<p>Syntax</p>
<figure class="highlight"><pre><div class="line"></div><div class="line">&lt;div r-animation=<span class="string">"Sequence"</span>&gt;&lt;/div&gt;</div><div class="line"></div><div class="line"><span class="label">Sequence:</span></div><div class="line">  Command (<span class="string">";"</span> Command)*</div><div class="line"></div><div class="line"><span class="label">Command:</span></div><div class="line">  CommandName<span class="string">":"</span> Param</div><div class="line"></div><div class="line"><span class="label">CommandName:</span> [-\w]+</div><div class="line"></div><div class="line"><span class="label">Param:</span> [^<span class="comment">;]+</span></div></pre></figure>

<p>The following sections will raise several questions and solve them later by <code>r-animation</code>. </p>
<blockquote>
<p><strong>please be a patience man until compelete the rest of the page, you will find the power of <code>r-animation</code> !</strong></p>
</blockquote>
<p><em>the examples will depend on awesome <a href="daneden.github.io/animate.css">animate.css</a> for some css-related animation.</em> </p>
<h3 id="Question_1:_When_the_animation_start">Question 1: When the animation start</h3>
<p>There are two types of Command: 1. <code>trigger</code>   2. <code>step</code>. </p>
<p><code>trigger</code> is used to trigger a animation sequence. and <code>step</code> is used to define a single animation.</p>
<p><strong>Command on</strong> (trigger): when specified event is triggered , starting the animation.</p>
<figure class="highlight html"><pre><div class="line"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">r-animation</span>=<span class="value">"on: click; class:  animated swing;"</span>&gt;</span> <span class="tag">&lt;/<span class="title">div</span>&gt;</span></div></pre></figure>

<p>this example means: </p>
<ol>
<li>when the element is clicked, trigged the animations.</li>
<li>Command <code>class</code> will addclass <code>animated swing</code>(maybe trigger animation) to element, when  the <code>animationend</code>(or <code>transitionend</code>) triggered, remove the class.</li>
<li>animation done</li>
</ol>
<h4 id="however,_how_to_hook_the_enter_and_leave_time_on_element?">however, how to hook the <code>enter</code> and <code>leave</code> time on element?</h4>
<p>regularjs emit the mock <code>enter</code> and <code>leave</code> event for hooking the element’s lifycle, you can also use <code>on</code> to handle it;</p>
<figure class="highlight html"><pre><div class="line"></div><div class="line"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">'box'</span> <span class="attribute">r-hide</span>= <span class="attribute">r-animation</span>=<span class="value">"</span></span></div><div class="line">  on: enter; class: animated bounceIn;</div><div class="line">  on: leave; class: animated bounceOut"&gt;</div><div class="line">  Box: enter</div><div class="line"><span class="tag">&lt;/<span class="title">div</span>&gt;</span></div></pre></figure>

<p>it is valid that defining multiply <code>trigger</code> on single <code>r-animation</code>. every <code>trigger</code> will create new animtion sequence.</p>
<h4 id="Is_there_any_other_trigger?">Is there any other trigger?</h4>
<p>now , we can take advantage of the data-driven framework to implement a more flexible command than <code>on</code> .</p>
<p><strong>Command when</strong> (trigger): when the specifed Expression is evaluated to true, starting the animation.</p>
<figure class="highlight html"><pre><div class="line"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">'box box-2'</span>  <span class="attribute">r-animation</span>=<span class="value">"when: test === true; class: animated swing"</span>&gt;</span></div><div class="line">Box2: triggered when test === true</div><div class="line"><span class="tag">&lt;/<span class="title">div</span>&gt;</span></div></pre></figure>

<p>when the <code>test === true</code> is computed to true, the animation will start.</p>
<blockquote>
<p><a href="http://codepen.io/leeluolee/pen/gkcKl/" target="_blank" rel="external"><span class="icon-arrow-right"> <strong>Result on Codepen</strong></span></a></p>
</blockquote>
<h3 id="Question_2:_How_to_make_the_animation_chainable?">Question 2: How to make the animation chainable?</h3>
<p><code>r-animation</code> is born to support chainable animation,you can simply sepecify multiply <code>steps</code> after one <code>trigger</code>.</p>
<p><strong>Example</strong></p>
<figure class="highlight html"><pre><div class="line"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">'box'</span> <span class="attribute">r-animation</span>=</span></div><div class="line">   "<span class="attribute">on:click</span>; </div><div class="line">      <span class="attribute">class:</span> <span class="attribute">animated</span> <span class="attribute">swing</span>;</div><div class="line">      <span class="attribute">class:</span> <span class="attribute">animated</span> <span class="attribute">shake</span>;</div><div class="line">      <span class="attribute">class:</span> <span class="attribute">animated</span> <span class="attribute">bounceOut</span>;</div><div class="line">      <span class="attribute">class:</span> <span class="attribute">animated</span> <span class="attribute">bounceIn</span>;</div><div class="line">        "&gt;</div><div class="line">  click me</div><div class="line"><span class="tag">&lt;/<span class="title">div</span>&gt;</span></div></pre></figure>

<p>now, you will see the steps animate one by one.</p>
<blockquote>
<p><a href="http://codepen.io/leeluolee/pen/kCqzJ/" target="_blank" rel="external"><span class="icon-arrow-right"> <strong>Result on Codepen</strong></span></a></p>
</blockquote>
<h3 id="Question_3:_How_to_animation_two_element_step_by_step?">Question 3: How to animation two element step by step?</h3>
<p>Thanks for the data-driven system. you can use the <code>call</code> command for evaluating a Expression. after evaluating, the digest phase(regularjs is also based on <strong>dirty-check</strong>) will be automately triggered, it can trigger other animation (work with <code>when</code>). </p>
<p><strong>Command call</strong>: evaluted a Expression, then enter the component’s digest phase. finaly step to next animation.</p>
<p><strong>Example</strong></p>
<figure class="highlight html"><pre><div class="line"></div><div class="line"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">'box animated'</span> <span class="attribute">r-animation</span>=</span></div><div class="line">     "<span class="attribute">when:test</span>; </div><div class="line">        <span class="attribute">class:</span> <span class="attribute">swing</span> ;</div><div class="line">        <span class="attribute">call:</span> <span class="attribute">otherSwing</span>=<span class="value">true</span> ;</div><div class="line">        <span class="attribute">class:</span> <span class="attribute">shake</span>"&gt;</div><div class="line">  box1: trigger by checkbox</div><div class="line"><span class="tag">&lt;/<span class="title">div</span>&gt;</span></div><div class="line">  </div><div class="line"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">'box animated'</span> <span class="attribute">r-animation</span>=</span></div><div class="line">     "<span class="attribute">when:</span> <span class="attribute">otherSwing</span>; </div><div class="line">        <span class="attribute">class:</span>  <span class="attribute">swing</span>; </div><div class="line">      "&gt;box2: after box1 swing<span class="tag">&lt;/<span class="title">div</span>&gt;</span></div></pre></figure>

<p>steps as follow:</p>
<ol>
<li>when <code>test</code> is computed to true, start box1’s animation</li>
<li>swing then call <code>otherSwing = true</code>;</li>
<li>box2’s <code>otherSwing</code> is evaluted to <code>true</code>. </li>
<li>box2 shakes, meanwhile box1 shakes;</li>
<li>done.</li>
</ol>
<blockquote>
<p><a href="http://codepen.io/leeluolee/pen/aHwoh/" target="_blank" rel="external"><span class="icon-arrow-right"> <strong>Result on Codepen</strong></span></a></p>
</blockquote>
<p>thanks for <code>call</code> and data-driven system, we can staying competitive with <code>javascript based animation</code> on control.</p>
<h3 id="Question_4:_Is_there_any_other_buildin_command?">Question 4: Is there any other buildin command?</h3>
<ul>
<li><p><code>wait</code>: delay for next animation</p>
<p><strong>example</strong></p>
</li>
</ul>
<figure class="highlight html"><pre><div class="line"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">'box animated'</span> <span class="attribute">r-animation</span>=</span></div><div class="line">     "<span class="attribute">on:click</span>; </div><div class="line">        <span class="attribute">class:</span> <span class="attribute">swing</span> ;</div><div class="line">        <span class="attribute">wait:</span> <span class="attribute">2000</span> ;</div><div class="line">        <span class="attribute">class:</span> <span class="attribute">shake</span>"&gt;</div><div class="line">  wait: click me</div><div class="line"><span class="tag">&lt;/<span class="title">div</span>&gt;</span></div></pre></figure>

<p>  the example means: after clicking, swing then waiting 2000ms, finally shake.</p>
<ul>
<li><p><code>style</code>: set style and waiting the <code>transitionend</code> (if the style trigger the <code>transition</code>)</p>
<p><strong>example</strong></p>
</li>
</ul>
<figure class="highlight html"><pre><div class="line"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">'box animated'</span> <span class="attribute">r-animation</span>=</span></div><div class="line">     "<span class="attribute">on:</span> <span class="attribute">click</span>; </div><div class="line">        <span class="attribute">class:</span>  <span class="attribute">swing</span>; </div><div class="line">        <span class="attribute">style:</span> <span class="attribute">color</span> #<span class="attribute">333</span>;</div><div class="line">        <span class="attribute">class:</span> <span class="attribute">bounceOut</span>;</div><div class="line">        <span class="attribute">style:</span> <span class="attribute">display</span> <span class="attribute">none</span>;</div><div class="line">      "&gt;style: click me <span class="tag">&lt;/<span class="title">div</span>&gt;</span></div></pre></figure>

<p>  add <code>transition</code> to make color fading effect work.</p>
<figure class="highlight css"><pre><div class="line"><span class="class">.box</span><span class="class">.animated</span><span class="rules">{</span></div><div class="line">   <span class="rule"><span class="attribute">transition</span>:<span class="value">  color <span class="number">1s</span> linear</span></span>;</div><div class="line"><span class="rule">}</span></div></pre></figure>

<p>  example means: after clicking, swing then set <code>style.color=#333</code>(trigger transition)… </p>
<blockquote>
<p><a href="http://codepen.io/leeluolee/pen/FhwGC/" target="_blank" rel="external"><span class="icon-arrow-right"> <strong>Result on Codepen</strong></span></a></p>
</blockquote>
<p>you can also extend custom command by your self. </p>
<h3 id="Question_5:_How_to_extend_Custom_Command?">Question 5: How to extend Custom Command?</h3>
<p>you can extend javascript-based Animation via  <code>Component.animation(name, handle)</code>. </p>
<p>for example, we need fading animation.</p>
<figure class="highlight javascript"><pre><div class="line">Regular.animation(<span class="string">"fade"</span>, <span class="function"><span class="keyword">function</span><span class="params">(step)</span></span>{</div><div class="line">  <span class="keyword">var</span> param = step.param,</div><div class="line">    element = step.element,</div><div class="line">    fadein = param === <span class="string">"in"</span>,</div><div class="line">    step = fadein?  <span class="number">1.05</span>: <span class="number">0.9</span>;</div><div class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span><span class="params">(done)</span></span>{ </div><div class="line">    <span class="keyword">var</span> start = fadein?  <span class="number">0.01</span>: <span class="number">1</span>;</div><div class="line">    <span class="keyword">var</span> tid = setInterval(<span class="function"><span class="keyword">function</span><span class="params">()</span></span>{</div><div class="line">      start *= step </div><div class="line">      <span class="keyword">if</span>(fadein && <span class="number">1</span>- start &lt; <span class="number">1e-3</span>){</div><div class="line">        start = <span class="number">1</span>; </div><div class="line">        clearInterval(tid);</div><div class="line">        done()</div><div class="line">      }<span class="keyword">else</span> <span class="keyword">if</span>(!fadein && start &lt; <span class="number">1e-3</span>){</div><div class="line">        start = <span class="number">0</span>;</div><div class="line">        clearInterval(tid);</div><div class="line">        done()</div><div class="line">      }</div><div class="line">      element.style.opacity = start;</div><div class="line">    }, <span class="number">1000</span> / <span class="number">60</span>) </div><div class="line">  }</div><div class="line">})</div></pre></figure>

<p>describe in template</p>
<figure class="highlight html"><pre><div class="line"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">'box animated'</span> <span class="attribute">r-animation</span>=</span></div><div class="line">       "<span class="attribute">on:click</span>; </div><div class="line">        <span class="attribute">class:</span> <span class="attribute">swing</span> ;</div><div class="line">        <span class="attribute">fade:</span> <span class="attribute">out</span> ;</div><div class="line">        <span class="attribute">fade:</span> <span class="attribute">in</span>;</div><div class="line">         "&gt;</div><div class="line">    fade: click me</div><div class="line"><span class="tag">&lt;/<span class="title">div</span>&gt;</span></div></pre></figure>

<p>the only thing you need to do is that: when your animation is compelete, call the function <code>done</code>.</p>
<blockquote>
<p><a href="http://codepen.io/leeluolee/pen/qJvry/" target="_blank" rel="external"><span class="icon-arrow-right"> <strong>Result on Codepen</strong></span></a></p>
</blockquote>
<p>you can also check the builtin’s sourcecode on <a href="https://github.com/regularjs/regular/blob/master/src/directive/animation.js#L71" target="_blank" rel="external">github</a>. it is realy dead simple!</p>
<h3 id="Question_6:_Need_An_compeletely_Example?">Question 6: Need An compeletely Example?</h3>
<p>let’s create a infinite animation for joke.</p>
<figure class="highlight html"><pre><div class="line"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">'box animated'</span> <span class="attribute">r-animation</span>=</span></div><div class="line">      "<span class="attribute">when:test</span>=<span class="value">=1;</span> </div><div class="line">         <span class="attribute">class:</span> <span class="attribute">shake</span>;</div><div class="line">         <span class="attribute">call:</span> <span class="attribute">test</span>=<span class="value">2</span> ;"</div><div class="line">         &gt;</div><div class="line">   shake</div><div class="line"> <span class="tag">&lt;/<span class="title">div</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">'box animated'</span> <span class="attribute">r-animation</span>=</span></div><div class="line">    "<span class="attribute">when:</span> <span class="attribute">test</span>=<span class="value">=2;</span> </div><div class="line">       <span class="attribute">class:</span>  <span class="attribute">bounce</span>; </div><div class="line">       <span class="attribute">call:</span> <span class="attribute">test</span>=<span class="value">3;</span></div><div class="line">     "&gt;box2: bounce<span class="tag">&lt;/<span class="title">div</span>&gt;</span></div><div class="line"> </div><div class="line"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">'box animated'</span> <span class="attribute">r-animation</span>=</span></div><div class="line">  "<span class="attribute">when:</span> <span class="attribute">test</span>=<span class="value">=3;</span> </div><div class="line">     <span class="attribute">class:</span>  <span class="attribute">swing</span>; </div><div class="line">     <span class="attribute">call:</span> <span class="attribute">test</span>=<span class="value">1;</span></div><div class="line">   "&gt;box2: swing<span class="tag">&lt;/<span class="title">div</span>&gt;</span></div></pre></figure>

<p>just as the logic described by the template. the sequence will never stopped.</p>
<blockquote>
<p><a href="http://codepen.io/leeluolee/pen/vrgqu/" target="_blank" rel="external"><span class="icon-arrow-right"> <strong>Result on Codepen</strong></span></a></p>
</blockquote>
<h2 id="End">End</h2>
<blockquote>
<h3 id="if_the_post_is_helpful_to_you,_gives_regularjs_a_star">if the post is helpful to you,  <a href="https://github.com/regularjs/regular" target="_blank" rel="external">gives regularjs a star</a></h3>
</blockquote>

    

  </div>
  
    <footer class="post-footer">
      <!-- Tweet button -->
<a href="https://twitter.com/share" class="twitter-share-button" data-url="http://regularjs.github.io/blog/2014/07/26/2014-7-26-animation-rethink/" data-text="Rethink declarative animation" data-hashtags="javascript, regularjs, HTML5 ">Tweet</a>
<!-- Facebook like button -->
<iframe src="//www.facebook.com/plugins/like.php?href=http%3A%2F%2Fregularjs.github.io%2Fblog%2F2014%2F07%2F26%2F2014-7-26-animation-rethink%2F&amp;width=90&amp;layout=button_count&amp;action=like&amp;show_faces=false&amp;share=false&amp;height=21&amp;appId=145365378826124" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:90px; height:21px;" allowTransparency="true"></iframe>
<!-- Google +1 button -->
<g:plusone size="medium" href="http://regularjs.github.io/blog/2014/07/26/2014-7-26-animation-rethink/"></g:plusone>
      
      
      <div class="clearfix"></div>
    </footer>
    
<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>

  

</article>
</div>

  
<footer class="m-footer">
  <p class="license">Release under <a href="https://github.com/regularjs/regular/blob/master/LICENSE" target="_blank">MIT License</a>| Copyright&nbsp;©&nbsp;2014&nbsp;&nbsp;<a href="https://leeluolee.github.io" target="_blank">@leeluolee</a>. Reserved</p>
  <p class="rights"> Background from <a href="http://subtlepatterns.com/shattered/" target="_blank">Shattered</a> | powered by <a href="//hexo.io">Hexo</a></p>

</footer>


  

<!-- Disqus -->
<script>
  var disqus_shortname = 'regularjs';
  
  var disqus_url = 'http://regularjs.github.io/blog/2014/07/26/2014-7-26-animation-rethink/';
  
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//go.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
  
</script>

<!-- Swiftype -->
<script>
var Swiftype = window.Swiftype || {};
(function() {
  Swiftype.key = 'fDxc-hEngMPFuZ1VP_FJ';
  /** DO NOT EDIT BELOW THIS LINE **/
  var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
  script.src = "//s.swiftypecdn.com/embed.js";
  var entry = document.getElementsByTagName('script')[0];
  document.getElementsByTagName('script')[0].parentNode.insertBefore(script, entry);
}());
</script>
<script src="/bower_components/jquery/dist/jquery.min.js" type="text/javascript"></script>

<script src="/bower_components/regularjs/dist/regular.min.js" type="text/javascript"></script>

<script src="/bower_components/codemirror/lib/codemirror.js" type="text/javascript"></script>

<script src="/bower_components/codemirror/mode/javascript/javascript.js" type="text/javascript"></script>

<script src="/bower_components/codemirror/mode/xml/xml.js" type="text/javascript"></script>


<script async src="//codepen.io/assets/embed/ei.js"></script>


<!-- Twitter -->
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

</body>
</html>